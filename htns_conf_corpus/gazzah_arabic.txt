Arabic Handwriting Texture Analysis for Writer Identification Using the DWT-Lifting Scheme Sami Gazzah1 - Najoua Essoukri Ben Amara2 1sami_gazzah@yahoo.fr 2Ecole Nationale d’Ingénieurs de Sousse Najoua.BenAmara@eniso.rnu.tn Abstract In this paper, we present an approach for writer identification using off-line Arabic handwriting. The proposed method explores the handwriting texture analysis by 2D Discrete Wavelet Transforms using lifting scheme. A comparative evaluation between textural features extracted by 9 different wavelet transform functions was done. A modular Multilayer Perceptron classifier was used. Experiments have shown that writer identification accuracies reach best performance levels with an average rate of 95.68%. Experiments have been carried out using a database of 180 text samples. The chosen text was made to guarantee the involvement of the various internal shapes and letter locations within an Arabic subword. 1. Introduction The offline handwritten text recognition represents the most challenging problem to solve in the optical character recognition field, due to wide variability of the writings and the absence of dynamic information relating to the various handwriting forms considered. The current tendency is to provide an additional source of information to the recognition system such as the structural properties of the language, usual lexicon vocabulary or writer identity. Writer identity offers a valuable additional source of information to the recognition system that leads to transforming the complexity of the multi-writer system into mono-writer ones. In spite of its usefulness and meaningful improvement in recognition for off-line handwriting, personal identification has been almost neglected. The identification task generally includes a comparison of a set of handwriting samples provided from an unknown author with each class reference pattern, and decides which reference pattern matches the unknown writer features best [1]. In addition, a person’s handwriting has long been considered as a behavioural biometric characteristic and accepted as a form of human identification especially in crime investigations. The individuality of handwriting has been the subject of intensive research in recent studies tempting to discriminate between authors [1, 2, 3]. In common sense assumption, each person writes in his own personal style yielding a text that can be characterized by enclosing a specific texture. Mathematically speaking, a texture is defined as the frequency, amplitude and shape variations over a surface [4]; i.e., an image texture can be considered as a function of the spatial variation in pixel intensities. Nowadays, the use of global characteristics based on texture analysis is an active research field, so more and more researchers have been interested in this field taking advantages of the latest advances in signal processing tool progresses. The goal of texture classification is to produce a classification map of the input image where each uniform textured-region is identified with the texture writer-class it belongs to [5]. The spatial frequency and orientation contents represent the features of each texture [6]. The analysis of texture is a research theme which has been developed considerably for several years. The potential applications are very important and cover wide areas such as textured region segmentation in the images [7], composition of Honeybee Pollen determinated by Texture Classification [8], analysis of the medical images [9], industrial surface inspection [10], optical font recognition [11]… Many techniques were implemented to extract textural features from handwritten text for writer identification. H.E.S. Said et al. [12] proposed a global method based on the use of multi-channel Gabor filter and grayscale co-occurrence matrices. For this method, 16 Gabor filters are applied to each uniform block of Latin handwriting text obtained by a specific preprocessing stage. Similarly, the same method was Authorized licensed use limited to: UNIVERSITY OF TENNESSEE LIBRARIES. Downloaded on November 16,2022 at 21:11:47 UTC from IEEE Xplore. Restrictions apply. applied by Al-Zoubeidy et al. [13] using Arabic handwriting text. Z.Y.He [14] tested 3 approaches based respectively on Gabor filters, DWT and contourlet texture analysis. In the first method, he applied 16-channel Gabor filters on a 64-Chinesecharacter textured image. In wavelet-based method, he firstly decomposed the handwriting image via Daubechies4 DWT at 3 levels, and then applied Generalized Gaussian Density (GGD) model on the approximation image and on horizontal and vertical subbands. In contourlet-based method, he first decomposed the handwriting image into 4 scales using 9-7 filter bank. Then each of the 3 fine scales was analyzed into 4 directional subbands. Finally, he modeled each subband using a GGD model. In this paper, we present a contribution to the writer identification using off-line Arabic handwriting. Our approach is based on the combination of global and structural features. Our various work in recognition of the off-line Arabic handwriting, shows the complexity of the task in particular in a multi-writer context. The variations within- and between-writers are accentuated by the calligraphic nature of Arabic script. The aim of this paper is to evaluate a new algorithm for writer identification based on the handwriting texture analysis. In our approach, a handwriting Arabic text, written by each writer can be seen as having a specific texture. In addition, we used to combine global and local features in order to emphasize the characterization. Global features were extracted by using the second generation wavelets (DWT using lifting scheme) which are briefly described in the next section. In section 3 we present the feature set extraction, while in section 4, a modular MLP classifier design and the experimental results are given. Conclusions and future work are drawn in the end. 2. DWT using lifting scheme The lifting scheme was first introduced by Win Sweldens in 1994. The main difference between this method and classical wavelets is that it doesn’t rely on the Fourier transform and it isn’t necessarily using translates and dilates of one wavelet function (mother wavelet) for constructing biorthogonal wavelets. The main idea of the lifting scheme is that the original signal is split into two subsets defined by the even and odd index signal samples, and then gradually a new wavelet is builds, with improved properties, by adding in new basis functions (figure 1) [15, 16]. This is held in three steps: • Split: In this step, the original image text S is split into two sub-images defined by the even ( So = S ) and the odd ( Se = S ) coefficient i 2i ii +21 pixel images starting with a “Lazy wavelet Transform (LWT)”. The LWT is a function which actually doesn't do anything, but which has the formal properties of a wavelet. • Primal Lifting step (Prediction L): It generates the wavelet coefficients Hi = Soi − L (Sei ) . • Dual Lifting step (Update U): We apply the update operator U to the wavelet coefficients computed above and we add Sei to obtain scaling coefficients. Li = Sei +U (Hi ) . Afterwards the results are normalized by multiplying with the factors kH and kL where: kH x kL=1. Figure 1. One dimensional Discrete Wavelet transform (1D-DWT) using lifting scheme A two dimensional Discrete Wavelet Transform (2D-DWT) is obtained by applying the 1D-DWT along the rows, and than on each column of a matrix. Figure 2 illustrates the decomposition of an image by 2D-DWT using filter banks Vs 2D-DWT using lifting scheme. Figure 2. Wavelet decomposition of the word “” This figure shows that the details coefficients are small in the case of lifting scheme compared to the classical filter bank that’s why we couldn’t almost distinguish information in the case of the DWT-lifting scheme. 3. Features Extracted Each selected feature should morphologically characterize the style of handwriting of each writer Authorized licensed use limited to: UNIVERSITY OF TENNESSEE LIBRARIES. Downloaded on November 16,2022 at 21:11:47 UTC from IEEE Xplore. Restrictions apply. (authorship) to dissociate it from the other writers (non-authorship). In our approach, we combined two types of features: structural and global ones. This hybrid approach allowed us to extract feature vectors from handwriting at text line level. In this section, we give a brief description of the two groups of features. 3.1. Structural features The first set is related to structural features which are [17]: Average line height: In a previous step, we fixed space between the text lines to avoid the overlaps between succeeding ones. Under this condition, the extraction of the text lines of writings becomes easier by the method of the horizontal projection profile. The height of the line is measured directly on the histogram. Spaces between subwords: An algorithm allows to cross the baseline and to calculate the average of white spaces between subwords. Inclination of the ascenders: First, we extract the zone delimiting the ascenders and then we measure the angle of inclination for each detected ascender. Features extracted from dots: These features are extracted from isolated diacritic dots. The height and the width of each diacritic dot are measured from its bounding box. 3.2. Global features The second group contains features extracted from grayscale image text in which the handwritten text is considered as a textured image. Lifting scheme approach: We used 2D-DWT for analyzing a textured image document. We first performed a horizontal wavelet transform by applying the lifting scheme operation on image sample rows than a vertical transform is performed using the lifting scheme operation over a column level. In every lifting level we obtained 4 images: the low frequency LL band and the detail bands LH, HL and HH (L/H stands for low/high frequency filtering respectively and the order of the succession letters means that the filtering operations are applied to rows/columns respectively). The LL subband is further decomposed in the same way until level three. We retain the mean and the standard deviation from each matrix subband (LL, HL, LH, and LL) as parameters describing the handwriting feature. Entropy: The entropy is a statistical measure of randomness (probability distribution) used to characterize the texture of the input image. Hence for each line text, the feature vector is composed of twenty parameters. 4. Experimentation and results In this section, we first describe our database design and then we present an experimental comparison between the results achieved using 9 different wavelet functions via lifting scheme. 4.1. Database description For the experiments reported in this paper, we have designed an Arabic letter source document which contains 505 characters, 15 numerals and 6 punctuations. The choice of the letter contents was made to ensure the involvement of the various internal shapes of the letter within a subword (isolated, initial, middle and end). Handwriting samples of 60 persons were collected. Each person was required to copy the same letter three times: two samples were used for the training stage and the other for the tests which makes a total of 180 A4 format sample pages. A black pen and a white sheet were provided. In our experiments, all handwritten text images were initially digitized in grayscale at a resolution of 300 dpi. Then via the preprocessing stage we removed salt and pepper noise by applying the median filter, extracted the text lines by horizontal projection profile method, and determined the bounding box of each text line. Structural and global features were extracted from line text. 4.2. Experimental results In this section we briefly describe the different techniques that we have conducted to implement a modular neural network. In fact, it has been shown that generally the modular architecture offers superiority in terms of convergence and recognition capability over non-modular network. In our case, the classification problem of the sixty writers was decomposed into two-classified sixty sub-problems: authorship and non-authorship. During the phase of training, a sub-network learned the features of the authorship and non-authorship. Thus, each sub-network learned the good examples as well as the bad ones (among the whole training base). In this stage we faced the problem of the non-proportionality between the numbers of the true examples compared to false ones. Each subnetwork learned two true examples and 118 false ones. This problem biased the results because in the training stage the system learned more non-authorship examples. To solve this problem, we used for each non-authorship writer text only one text line chosen randomly from the whole document (each subnetwork learned about 32 lines from true examples Vs 59 lines from false ones). Authorized licensed use limited to: UNIVERSITY OF TENNESSEE LIBRARIES. Downloaded on November 16,2022 at 21:11:47 UTC from IEEE Xplore. Restrictions apply. Finally, the test pages were presented at each of the sixty trained sub-networks. Multi-Layer Perceptron (MLP) classifiers were applied in the recognition of the same set of classes. A modular architecture network classifier was adopted. It consisted of an ensemble of 60 MLP sub-networks. The architecture of each subnetwork is composed of three-layers of neurons including a hidden one. The number of neurons in the input layer is equal to the length of features’ vectors. One output neuron takes Boolean values. In the absence of absolute rules allowing to choose the most adequate analyzing wavelets for the description of cursive Arabic subword problem, we tested about 11 wavelet functions and we reported here 9 functions: 3 Daubechies wavelets, 4 CohenDaubechies-Feauveau wavelets, Lazy Wavelet Transform and Symlets wavelets. By the use of the same wavelet functions with different length of lowpass and highpass analysis of filter taps (the number of taps denotes the number of coefficients in the wavelet filter), we wanted to make an empirical evaluation on the discriminative effect of each feature set. Recent investigations by Kautsky et al. in [18] have reported that in 2 D-DWT wavelets with more taps are appropriate for images without sharp edges and many details. Shorter wavelets perform better on images with prominent high-frequency information and are able to capture more details. Therefore, they recommended for empirical reasons the use of 6-tap wavelets as a good compromise for common images. Globally, the results produced by the whole selected wavelets set were almost equal and close to 95%. The networks remained quite biased although we adopted countermeasures to reduce the non-proportionality between the numbers of true examples compared to the false ones. The system learned the bad examples better than the good ones. The achieved results are not as good as those obtained with the approach based on DWT-filter banks [19], they remain biased although the global scores are a little bit better: 94.11% with filter banks approach Vs 95.52% with lifting scheme. 5. Conclusion In this paper, we present a novel approach for writer identification using off-line Arabic handwriting. Experiments were carried on a database of 180 text samples. We tested an approach based on the combination of local and global feature sets. Global characteristics were extracted with 2D DWT using lifting scheme. A handwritten text was considered as enclosing a behavioural texture characteristic and it was fully analyzed in different scales. To compare the influence of various wavelets, we used nine different wavelet transform functions to describe cursive Arabic subwords. MLP classifiers were applied in the recognition of the same set of classes. The classification average rate was almost equal to 95% when using the nine wavelet functions. However, we faced the problem of class imbalance between authorship and non-authorship instances in the training stage. For solving this problem we opted for random sampling, although, we may omit some relevant features. More extended efforts are under development to study the effect of the imbalance for the writer identification system and testing re-sampling approaches. 6.References [1] S. N. Srihari, S. H.Cha, H. Arora, S. Lee, “Individuality of handwriting”, Journal of Forensic Sciences, vol. 47, issue 4, 2002, pp. 856-872. [2] A. Bensefia, T. Paquet, L. Heutte. Handwritten document analysis for automatic writer recognition. Electronic Letters on Cumputer Vision and Image Analysis, 2005, vol. 5, no. 2, pp. 72-86. [3] V. Pervouchinea, G. Leedhamb, “Extraction and analysis of forensic document examiner features used for writer identification”, Pattern Recognition, vol. 40, 2007, pp. 1004– 1013. [4] O. Svensson, K. Abrahamsson, J.Engelbrektsson, M.Nicholas, H. Wikström and M. Josefson, “An evaluation of 2D-wavelet filters for estimation of differences in textures of pharmaceutical tablets”, World Scientific Publishing Co., vol. 84, Issues 1-2, 2006, pp. 3-8. [5] C. H. Chen and L. F. Pau, “Texture Analysis”, the Handbook of Pattern Recognition and Computer Vision (2nd Edition), P. S. P. Wang (eds.), World Scientific Publishing Co., 1998, pp. 207-248. [6] Y. Zhu, T.Tan, and Y. Wang, “Biometric Personal Identification Based on Handwriting”, 15th International Conference on Pattern Recognition, vol. II, Spain, 2000, pp. 2797-2800. [7] D. M. Tsaia, S.K. Wua and M.C. Chen, “Optimal Gabor filter design for texture segmentation using stochastic optimization”, Image and Vision Computing, vol. 19, issue 5, 2001, pp. 299-316. [8] P. Carrión, E. Cernadas, J.F. Gálvez and E. Diazlosada, “Determine the composition of honeybee pollen by texture classification”, Lecture notes on computer science, proceeding in the Iberian Conference on Pattern Recognition and Image Analysis, vol. 2652, 2003, pp 158-167. Authorized licensed use limited to: UNIVERSITY OF TENNESSEE LIBRARIES. Downloaded on November 16,2022 at 21:11:47 UTC from IEEE Xplore. Restrictions apply. [9] M. Mojsilović, Popović, S. Marković, and M. Krstić, “Characterization of visually similar diffuse diseases from B-scan liver images using nonseparable wavelet transform”, IEEE Transaction on Medical Imaging, vol.17, N°4, 1998, pp. 541-549. [10] D. Wolf and R. Husson, “Application des ondelettes à l’analyse de texture et à l’inspection de surface industrielle”, Journal. Phys., vol. 3, France, 1993, pp. 2133-2148. [11] Y. Zhu, T. Tan and Y. Wang, “Font Recognition. based on Global Texture Analysis”, IEEE Trans. on. On Pattern Analysis and Machine Intelligence, vol. 23, no. 10, 2001, pp. 1192-1200. [12] H.E.S. Said, T.N. Tan and K.D,Baker, ”Personal identifi-cation based on handwriting”, Pattern Recognition, vol. 33, 2000, pp. 149–160. [13] L. M. AL-Zoubeidy and H. F Al-Najar, “Arabic writer identification for handwriting images”, International Arab Conference on Information Technology, Amman, 2005, pp. 111-117. [14] Z.Y. He, ”A Contourlet-based method for writer identification”, The HKBU Second Computer Science Postgraduate Research Symposium, Hong Kong, 2005, pp 61-66. [15] W. Sweldens, “Wavelets and the lifting scheme, “A 5 minute tour”, Zeitschrift für Angewandte Mathematik und Mechanik, vol. 76 (Suppl. 2), 1996. pp. 41-44. [16] I. Daubechies and W. Sweldens, “Factoring wavelet transforms into lifting steps”, Journal of Fourier Analysis and Applications, vol. 4,1998 , pp. 245–267. [17] S. Gazzah, N. Essoukri Ben Amara: “Writer Identification using SVM Classifier and Genetic Algorithm for Optimal futures selection”,International Arab Conference on Information Technology, Amman, 2005, pp. 461-466. [18] J. Kautsky, J. Flusser, B. Zitovà and S. Simberovà, “A new wavelet-based measure of image focus”, Pattern Recognition Letters, vol. 23, 2002, pp 1785–1794. [19] S. Gazzah, N. Essoukri Ben Amara: “Writer Identification Using Modular MLP Classifier and Genetic Algorithm for Optimal Features Selection”, Lecture Notes in Computer Science, International Symposium on Neural Networks, China, Vol. 3972, 2006, pp. 271-276. Table1. Classification results using different transforms. writer9/7 DB2 DB3 DB5 Cdf3.3 Cdf4.2 Cdf6.6 Sym6 Lazy writer9/7 DB2 DB3 DB5 Cdf3.3 Cdf4.2 Cdf6.6 Sym6 Lazy 1 96,16 96.27 95,48 95.82 96.38 96.38 95.25 95.48 94.92 31 97.40 97.74 97.74 97.29 97.40 96,38 97.74 96.73 97.52 2 93,90 94.69 96,05 96.84 93.11 95.71 94.35 94.70 94.80 32 91.87 95.37 94.81 95.26 94.58 95,71 94.81 94.13 94.81 3 95,15 96.84 96,61 97.07 96.28 95.82 95.37 96.84 97.63 33 78.02 96.51 94.81 95.83 91.77 95,82 94.93 94.14 94.25 4 94,58 95.71 95,37 96.84 94.63 95.93 95.25 93.67 95.59 34 70.20 95.60 94.58 93.45 94.47 95,93 94.58 92.10 94.92 5 91,20 94.13 93,79 93.68 94.58 92.66 89.50 94.47 93.91 35 94.36 94.36 94.36 94.70 95.26 92,66 93.91 95.71 95.82 6 96,84 96.95 97,07 96.95 96.50 97.07 97.52 95.37 95.49 36 93.45 94.81 93.91 94.47 94.92 97,07 93.00 92.78 92.33 7 97,06 96.38 95,82 96.61 96.61 95.48 94.35 95.82 97.18 37 91.31 95.26 95.48 94.24 96.16 95,48 96.05 94.70 96.16 8 95,82 95.37 95,14 92.77 96.38 95.37 94.69 95.25 94.01 38 96.61 97.63 97.63 97.40 97.52 95,37 98.31 97.63 98.31 9 95,14 95.82 94,46 94.80 92.88 93.11 93.11 94.12 93.56 39 95.25 95.14 96.16 97.40 95.14 93,11 95.14 96.38 96.28 10 95,93 94.80 95,14 94.01 91.75 95.25 95.25 94.01 93.67 40 85.80 93.80 94.25 95.27 94.36 95,25 94.48 93.57 93.46 11 96,27 95.48 94,35 95.93 94.35 95.03 94.80 95.03 93.56 41 96.62 93.91 95.27 93.57 96.28 95,03 92.33 94.25 94.36 12 95,48 97.06 97,17 97.40 97.17 96.83 96.61 95.93 96.61 42 95.49 94.14 95.60 94.81 96.51 96,83 96.17 95.60 93.12 13 95,59 96.38 93,90 95.25 94.35 94.35 94.58 95.14 95.93 43 97.86 97.74 97.52 97.63 97.52 94,35 97.40 96.16 97.29 14 96,16 94.69 96,61 95.03 95.71 96.38 96.61 94.46 96.95 44 96.39 93.79 93.00 93.57 94.02 96,38 94.70 94.81 96.28 15 93,67 95.93 97,06 96.05 95.93 96.95 95.48 93.56 94.92 45 88.81 95.93 95.93 97.06 96.27 96,95 95.14 92.32 91.75 16 94,92 95.59 95,37 96.72 97.51 96.38 95.37 95.82 96.50 46 83.32 91.32 92.33 94.03 92.79 96,38 91.88 91.21 94.14 17 94,13 95.71 94,81 93.91 95.82 96.05 95.26 95.15 94.81 47 94.36 96.05 95.03 95.26 96.84 96,05 95.94 95.26 95.71 18 97,51 96.84 96,95 96.05 96.38 95.25 96.16 94.58 96.50 48 75.14 96.38 96.16 95.14 96.61 95,25 93.11 94.46 95.14 19 95,82 96.61 94,01 96.50 94.63 94.12 94.24 92.88 96.50 49 94.80 94.12 94.01 94.58 95.25 94,12 95.93 95.14 95.59 20 96,05 95.59 95,71 95.37 95.93 96.61 95.59 96.05 97.51 50 75.03 94.92 94.01 95.48 96.16 96,61 95.25 95.48 95.71 21 98,08 97.06 97,06 97.18 96.38 97.18 97.63 97.06 97.85 51 94.70 96.73 96.50 96.16 96.39 97,18 96.73 96.50 96.84 22 96,27 96.05 96,61 95.25 96.50 96.95 95.37 96.50 97.63 52 95.82 97.63 96.39 95.94 96.50 96,95 96.28 96.61 95.49 23 93,56 94.69 95,48 94.92 92.88 95.59 95.71 95.71 93.90 53 94.69 96.38 97.06 96.61 94.92 95,59 94.80 95.82 97.18 24 94,46 95.59 95,37 95.93 95.82 95.03 96.05 94.69 98.19 54 82.51 96.16 96.84 94.70 97.63 95,03 95.49 95.94 92.33 25 94,69 95.71 97,18 95.48 95.93 95.82 96.61 95.48 95.93 55 90.18 97.18 97.07 97.86 97.18 95,82 97.63 95.49 97.18 26 96,27 94.68 94,34 94.91 97.29 96.15 96.72 94.68 95.02 56 94.24 93.12 93.45 94.58 96.05 96,15 96.50 95.82 92.33 27 95,03 95.60 96,50 94.81 94.81 95.03 93.57 95.15 95.26 57 84.63 96.16 95.93 96.84 95.82 95,03 96.84 96.95 96.61 28 95,93 94.80 94,46 95.93 95.71 95.48 93.11 94.70 95.37 58 96.73 97.07 95.49 97.63 96.28 95,48 95.37 96.27 97.86 29 95,03 94.24 96,38 96.50 97.74 96.38 96.05 95.14 96.61 59 96.16 96.16 96.05 96.05 95.94 96,38 96.73 94.81 95.49 30 91,64 94.12 92,09 96.05 93.11 94.35 93.79 94.24 94.01 60 97.97 97.63 98.05 97.97 97.40 94,35 97.99 98.19 97.97 Authorized licensed use limited to: UNIVERSITY OF TENNESSEE LIBRARIES. Downloaded on November 16,2022 at 21:11:47 UTC from IEEE Xplore. Restrictions apply. 